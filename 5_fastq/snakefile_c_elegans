import pandas as pd

df = pd.read_csv('SraRunTable_c_elegans.txt', sep=',', header=0)

# append all accession number to a list
ACCESSIONS = []

for i in df['Run']:
    ACCESSIONS.append(i)

rule all:
    input:
        expand("fastq_c_elegans/{accession}.fastq.gz", accession=ACCESSIONS),
        expand("trimmed_elegans/{accession}.fastq.gz", accession=ACCESSIONS),
        expand("fastq_c_elegans/qc/{accession}.fastqc.html", accession=ACCESSIONS),
        expand("trimmed_elegans/qc/{accession}.fastqc.html", accession=ACCESSIONS),
        "multiqc_report_elegans.html"

rule fetch_fastq:
    shell:
        "parallel-fastq-dump --sra-id $line --threads 32 --outdir fastq_c_elegans --gzip"

rule fastq_qc:

rule trim_filter:

rule trim_qc:

rule report:

rule fetch_genome:

rule star_sa:

rule star_align_first:

rule star_align_second:

rule hisat_align:

rule report:

rule convert_hisat:

rule merge_hisat:

rule flagstat:

rule qualimap:

rule report: