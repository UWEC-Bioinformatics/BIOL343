import pandas as pd

df = pd.read_csv("SraRunTable_Placenta.txt", sep = ",", header = 0)

ACCESSIONS = []

for asn in df["Run"]:
    ACCESSIONS.append(asn)

rule all:
    input:
        expand("fastq_placenta/se_placenta/{accession}.fastq.gz", accession=ACCESSIONS)

rule get_fastq_se:
    output: "fastq_placenta/se_placenta/{accession}.fastq.gz"
    log: "logs_placenta/se_placenta/{accession}.log"
    params:
        extra="--skip-technical"
    threads: 16
    wrapper:
        "0.80.2/bio/sra-tools/fasterq-dump"
